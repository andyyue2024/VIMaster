# ä»·å€¼æŠ•èµ„åˆ†æç³»ç»Ÿ (VIMaster)

## é¡¹ç›®ç®€ä»‹

åŸºäº akshare æ•°æ®æºå’Œä»·å€¼æŠ•èµ„ç†è®ºè®¾è®¡çš„å¤šå±‚æ¬¡è‚¡ç¥¨åˆ†æç³»ç»Ÿã€‚ç³»ç»Ÿé‡‡ç”¨**åº”ç”¨å±‚ã€è°ƒåº¦å±‚ã€æ•°æ®æ¨¡å‹å±‚**ä¸‰å±‚åˆ†å±‚æ¶æ„ï¼Œé€šè¿‡ **9 ä¸ªç‹¬ç«‹ Agent** è¿›è¡Œç»¼åˆåˆ†æï¼Œä¸ºæŠ•èµ„è€…æä¾›ç»“æ„åŒ–çš„æŠ•èµ„å†³ç­–æ”¯æŒã€‚

## æ ¸å¿ƒæ¶æ„

### ä¸‰å±‚åˆ†å±‚è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         åº”ç”¨å±‚ (Application Layer)       â”‚
â”‚    CLIæ¥å£ / æŠ¥å‘Šç”Ÿæˆ / ç”¨æˆ·äº¤äº’         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         è°ƒåº¦å±‚ (Scheduler Layer)         â”‚
â”‚  WorkflowScheduler / AnalysisManager    â”‚
â”‚    Agentç¼–æ’ / ä¾èµ–ç®¡ç† / ç»“æœèšåˆ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      æ•°æ®æ¨¡å‹å±‚ (Data Model Layer)       â”‚
â”‚   DataModels / AkshareDataProvider     â”‚
â”‚    è‚¡ç¥¨åˆ†æä¸Šä¸‹æ–‡ / è´¢åŠ¡æ•°æ®è·å–        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9 ä¸ªæ ¸å¿ƒ Agent

| # | Agent åç§° | åŠŸèƒ½æè¿° |
|---|-----------|--------|
| 1 | **è‚¡æƒæ€ç»´ Agent** | è¯„ä¼°ä¼ä¸šç›ˆåˆ©èƒ½åŠ›å’Œé•¿æœŸå¢é•¿æ½œåŠ› |
| 2 | **æŠ¤åŸæ²³ Agent** | åˆ†æä¼ä¸šç«äº‰ä¼˜åŠ¿ï¼ˆå“ç‰Œã€æˆæœ¬ã€ç½‘ç»œæ•ˆåº”ç­‰ï¼‰ |
| 3 | **è´¢åŠ¡åˆ†æ Agent** | è¯„ä¼°è´¢åŠ¡æŒ‡æ ‡ï¼ˆROEã€æ¯›åˆ©ç‡ã€ç°é‡‘æµã€è´Ÿå€ºç‡ï¼‰ |
| 4 | **ä¼°å€¼ Agent** | è®¡ç®—å†…åœ¨ä»·å€¼ï¼ˆDCFã€PEã€PBç»¼åˆä¼°å€¼ï¼‰ |
| 5 | **å®‰å…¨è¾¹é™… Agent** | åˆ†æä»·æ ¼ä¸ä»·å€¼çš„å·®å¼‚ï¼Œç¡®ä¿æŠ•èµ„å®‰å…¨ |
| 6 | **ä¹°å…¥ç‚¹ Agent** | è¯†åˆ«ä¹°å…¥æ—¶æœºï¼ˆæ‚²è§‚ã€å›°éš¾ã€è¯¯è§£ï¼‰ |
| 7 | **å–å‡ºçºªå¾‹ Agent** | è¯†åˆ«å–å‡ºä¿¡å·ï¼ˆåŸºæœ¬é¢ã€é«˜ä¼°ã€æœºä¼šï¼‰ |
| 8 | **é£é™©ç®¡ç† Agent** | è¯„ä¼°æŠ•èµ„é£é™©ï¼ˆèƒ½åŠ›åœˆã€æ æ†ã€è¡Œä¸šã€å…¬å¸ï¼‰ |
| 9 | **å¿ƒç†çºªå¾‹ Agent** | ç”ŸæˆæŠ•èµ„å†³ç­–å’Œè¡Œä¸ºçºªå¾‹å»ºè®® |

## é¡¹ç›®ç»“æ„

```
VIMaster/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ app.py                           # åº”ç”¨å±‚ - CLIæ¥å£
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base_agent.py               # AgentåŸºç±»
â”‚   â”‚   â””â”€â”€ value_investing_agents.py   # 9ä¸ªå…·ä½“Agentå®ç°
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ data_models.py              # æ•°æ®æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ akshare_provider.py         # akshareæ•°æ®æä¾›è€…
â”‚   â””â”€â”€ schedulers/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ workflow_scheduler.py       # è°ƒåº¦å±‚ - å·¥ä½œæµå¼•æ“
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py                     # pytesté…ç½®å’Œfixtures
â”‚   â”œâ”€â”€ unit/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ test_models_agents.py      # å•å…ƒæµ‹è¯•
â”‚   â””â”€â”€ integration/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ test_workflow.py            # é›†æˆæµ‹è¯•
â”œâ”€â”€ requirements.txt                    # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ pytest.ini                         # pytesté…ç½®
â”œâ”€â”€ run.py                             # ä¸»ç¨‹åºå…¥å£
â””â”€â”€ README.md                          # æœ¬æ–‡ä»¶
```

## æ•°æ®æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¾“å…¥è‚¡ç¥¨ä»£ç      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥éª¤1: æ•°æ®å‡†å¤‡              â”‚
â”‚  AkshareDataProviderè·å–æ•°æ®  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥éª¤2-3: åŸºç¡€åˆ†æï¼ˆå¯å¹¶è¡Œï¼‰          â”‚
â”‚  - è‚¡æƒæ€ç»´Agent                     â”‚
â”‚  - æŠ¤åŸæ²³Agent                       â”‚
â”‚  - è´¢åŠ¡åˆ†æAgent                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥éª¤4-7: ä¼°å€¼ä¸äº¤æ˜“åˆ†æ          â”‚
â”‚  - ä¼°å€¼Agent                      â”‚
â”‚  - å®‰å…¨è¾¹é™…Agent                  â”‚
â”‚  - ä¹°å…¥ç‚¹Agent                    â”‚
â”‚  - å–å‡ºç‚¹Agent                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥éª¤8-9: é£é™©ä¸å†³ç­–             â”‚
â”‚  - é£é™©ç®¡ç†Agent                 â”‚
â”‚  - å¿ƒç†çºªå¾‹Agent                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœ€ç»ˆåŒ–: ç”Ÿæˆç»¼åˆæŠ¥å‘Š              â”‚
â”‚  - ç»¼åˆè¯„åˆ† (0-100)              â”‚
â”‚  - æŠ•èµ„ä¿¡å·                       â”‚
â”‚  - åˆ†ææ‘˜è¦                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å®‰è£…å’Œè¿è¡Œ

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# Python 3.8+
python --version

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
python -m venv .venv
.venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. ä½¿ç”¨æ–¹å¼

#### äº¤äº’æ¨¡å¼ï¼ˆæ¨èï¼‰

```bash
python run.py
```

ç„¶åè¾“å…¥å‘½ä»¤ï¼š
```
analyze 600519                    # åˆ†æå•åªè‚¡ç¥¨ï¼ˆè´µå·èŒ…å°ï¼‰
portfolio 600519 000858           # åˆ†æå¤šåªè‚¡ç¥¨
buy 600519 000858                 # æŸ¥æ‰¾ä¹°å…¥æ¨è
help                              # æ˜¾ç¤ºå¸®åŠ©
exit                              # é€€å‡º
```

#### å‘½ä»¤è¡Œæ¨¡å¼

```bash
# åˆ†æå•åªè‚¡ç¥¨
python run.py analyze 600519

# åˆ†æå¤šåªè‚¡ç¥¨
python run.py portfolio 600519 000858 000001

# æŸ¥æ‰¾ä¹°å…¥æ¨è
python run.py buy 600519 000858

# æ˜¾ç¤ºå¸®åŠ©
python run.py help
```

### 3. è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œå…¨éƒ¨æµ‹è¯•
pytest

# è¿è¡Œå•å…ƒæµ‹è¯•
pytest tests/unit -v

# è¿è¡Œé›†æˆæµ‹è¯•
pytest tests/integration -v

# æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡
pytest --cov=src tests/

# è¿è¡Œç‰¹å®šæµ‹è¯•
pytest tests/unit/test_models_agents.py::TestDataModels::test_financial_metrics_creation -v
```

## æŠ•èµ„ä¿¡å·è¯´æ˜

ç³»ç»Ÿçš„æŠ•èµ„å»ºè®®åŒ…å«5ä¸ªçº§åˆ«ï¼š

| ä¿¡å· | å«ä¹‰ | æ¨èè¡ŒåŠ¨ |
|------|------|---------|
| ğŸŸ¢ğŸŸ¢ **å¼ºçƒˆä¹°å…¥** | ç»¼åˆè¯„åˆ† â‰¥80ï¼Œå¤šé¡¹æŒ‡æ ‡ä¼˜ç§€ | é€‚é‡å»ºä»“ï¼Œè¾ƒé«˜ä»“ä½ |
| ğŸŸ¢ **ä¹°å…¥** | ç»¼åˆè¯„åˆ† â‰¥70ï¼Œå®‰å…¨è¾¹é™…å……è¶³ | é€‚é‡å»ºä»“ï¼Œä¸­ç­‰ä»“ä½ |
| ğŸŸ¡ **æŒæœ‰** | ç»¼åˆè¯„åˆ† 50-70ï¼Œä¸­ç­‰é£é™© | è§‚æœ›ï¼Œç­‰å¾…æ›´å¥½æœºä¼š |
| ğŸ”´ **å–å‡º** | ç»¼åˆè¯„åˆ† <50ï¼Œæˆ–åŸºæœ¬é¢æ¶åŒ– | åˆ†æ¬¡å–å‡ºï¼Œé™ä½é£é™© |
| ğŸ”´ğŸ”´ **å¼ºçƒˆå–å‡º** | åŸºæœ¬é¢ä¸¥é‡æ¶åŒ–ï¼Œä¸¥é‡é«˜ä¼° | å¿«é€Ÿæ¸…ä»“ï¼Œè§„é¿é£é™© |

## å…³é”®æ•°æ®æ¨¡å‹

### StockAnalysisContextï¼ˆåˆ†æä¸Šä¸‹æ–‡ï¼‰

è´¯ç©¿æ•´ä¸ªåˆ†ææµç¨‹çš„æ ¸å¿ƒæ•°æ®ç»“æ„ï¼ŒåŒ…å«ï¼š

- `financial_metrics` - è´¢åŠ¡æŒ‡æ ‡
- `competitive_moat` - ç«äº‰ä¼˜åŠ¿
- `valuation` - ä¼°å€¼åˆ†æç»“æœ
- `buy_signal` / `sell_signal` - ä¹°å–ä¿¡å·
- `risk_assessment` - é£é™©è¯„ä¼°
- `investment_decision` - æŠ•èµ„å†³ç­–
- `overall_score` - ç»¼åˆè¯„åˆ† (0-100)
- `final_signal` - æœ€ç»ˆæŠ•èµ„ä¿¡å·

### AnalysisReportï¼ˆåˆ†ææŠ¥å‘Šï¼‰

å¤šè‚¡ç¥¨åˆ†æçš„æ±‡æ€»æŠ¥å‘Šï¼ŒåŒ…å«ï¼š

- æ€»åˆ†æè‚¡ç¥¨æ•°
- å„ä¿¡å·çº§åˆ«çš„è‚¡ç¥¨ç»Ÿè®¡
- è¯¦ç»†çš„è‚¡ç¥¨åˆ†æåˆ—è¡¨

## ä»·å€¼æŠ•èµ„ç†è®ºä¾æ®

æœ¬ç³»ç»ŸåŸºäº `topic.txt` ä¸­çš„ä»·å€¼æŠ•èµ„å“²å­¦ï¼ŒåŒ…æ‹¬ï¼š

1. **è‚¡æƒæ€ç»´** - å°†è‚¡ç¥¨è§†ä¸ºä¼ä¸šæ‰€æœ‰æƒ
2. **å®‰å…¨è¾¹é™…** - ä»…åœ¨ä»·æ ¼æ˜¾è‘—ä½äºå†…åœ¨ä»·å€¼æ—¶ä¹°å…¥
3. **å¸‚åœºå…ˆç”Ÿ** - åˆ©ç”¨å¸‚åœºé”™è¯¯æŠ¥ä»·
4. **èƒ½åŠ›åœˆ** - åšå®ˆè‡ªå·±æ·±åˆ»ç†è§£çš„è¡Œä¸š
5. **æŠ¤åŸæ²³** - å¯»æ‰¾å…·æœ‰ç«äº‰ä¼˜åŠ¿çš„ä¼ä¸š
6. **åŸºæœ¬é¢åˆ†æ** - æ³¨é‡ä¼ä¸šè´¢åŠ¡çŠ¶å†µ
7. **é€†å‘æ€ç»´** - åœ¨å¸‚åœºæåº¦æ‚²è§‚æ—¶ä¹°å…¥
8. **é£é™©ç®¡ç†** - è§„é¿æ— çŸ¥ã€é¿å…é«˜ä»·ã€æ‹’ç»æ æ†
9. **å¿ƒç†çºªå¾‹** - å…‹æœäººæ€§å¼±ç‚¹ï¼Œéµå¾ªæŠ•èµ„çºªå¾‹

## æ‰©å±•æ€§

ç³»ç»Ÿè®¾è®¡æ”¯æŒä»¥ä¸‹æ‰©å±•ï¼š

1. **æ–° Agent å¢åŠ ** - ç»§æ‰¿ BaseAgentï¼Œå®ç° analyze() æ–¹æ³•
2. **æ–°æ•°æ®æº** - æ‰©å±• AkshareDataProvider
3. **æ–°ä¼°å€¼æ¨¡å‹** - åœ¨ ValuationAgent ä¸­å¢åŠ æ¨¡å‹
4. **æ›´å¤æ‚çš„å·¥ä½œæµ** - é…ç½® WorkflowScheduler çš„æ‰§è¡Œç­–ç•¥
5. **Web UI** - åœ¨åº”ç”¨å±‚æ·»åŠ  Flask/FastAPI æ¥å£

## ç¤ºä¾‹è¾“å‡º

```
================================================================================
ä»·å€¼æŠ•èµ„åˆ†ææŠ¥å‘Š - 600519
================================================================================

ã€è´¢åŠ¡æŒ‡æ ‡ã€‘
  å½“å‰ä»·æ ¼:     1000.0
  PEæ¯”ç‡:       25.0
  PBæ¯”ç‡:       10.0
  ROE:          0.2
  æ¯›åˆ©ç‡:       0.6

ã€ç«äº‰ä¼˜åŠ¿ï¼ˆæŠ¤åŸæ²³ï¼‰ã€‘
  æŠ¤åŸæ²³å¼ºåº¦:   9.0/10
  å“ç‰Œå¼ºåº¦:     0.8/1.0
  æˆæœ¬ä¼˜åŠ¿:     0.7/1.0

ã€ä¼°å€¼åˆ†æã€‘
  å†…åœ¨ä»·å€¼:     1200.00
  åˆç†ä»·æ ¼:     1200.00
  å®‰å…¨è¾¹é™…:     20.00%

ã€æŠ•èµ„å†³ç­–ã€‘
  æœ€ç»ˆå»ºè®®:     buy
  ä¿¡å¿µå¼ºåº¦:     0.70
  æ­¢æŸä»·:       900.00
  æ­¢ç›ˆä»·:       1200.00

ã€ç»¼åˆè¯„ä¼°ã€‘
  ç»¼åˆè¯„åˆ†:     76.50/100
  æœ€ç»ˆä¿¡å·:     buy
================================================================================
```

## å¸¸è§é—®é¢˜

### Q: ç³»ç»Ÿçš„å‡†ç¡®ç‡æ˜¯å¤šå°‘ï¼Ÿ
A: ç³»ç»Ÿæä¾›ç»“æ„åŒ–çš„åˆ†ææ¡†æ¶ï¼Œç»“æœä»…ä¾›å‚è€ƒï¼ŒæŠ•èµ„å†³ç­–éœ€ç»“åˆä¸ªäººåˆ¤æ–­å’Œé£é™©æ‰¿å—èƒ½åŠ›ã€‚

### Q: å¦‚ä½•è·å–æœ€æ–°çš„è‚¡ç¥¨æ•°æ®ï¼Ÿ
A: ç³»ç»Ÿä½¿ç”¨ akshare åº“ï¼Œè‡ªåŠ¨ä»å®æ—¶æ•°æ®æºè·å–ï¼Œéœ€è¦ç½‘ç»œè¿æ¥ã€‚

### Q: ç³»ç»Ÿæ”¯æŒå“ªäº›è‚¡ç¥¨ä»£ç æ ¼å¼ï¼Ÿ
A: æ”¯æŒæ ‡å‡†çš„ 6 ä½æ•°å­—ä»£ç ï¼ˆå¦‚ï¼š600519ã€000858ï¼‰ã€‚

### Q: å¯ä»¥è‡ªå®šä¹‰åˆ†ææŒ‡æ ‡å—ï¼Ÿ
A: å¯ä»¥ï¼Œé€šè¿‡ç»§æ‰¿ BaseAgent åˆ›å»ºè‡ªå®šä¹‰ Agentï¼Œæˆ–ä¿®æ”¹ç°æœ‰ Agent çš„é€»è¾‘ã€‚

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤ Issue æˆ– Pull Requestã€‚

---

**é¡¹ç›®çŠ¶æ€**: âœ… å®Œæˆæ ¸å¿ƒåŠŸèƒ½ | ğŸ”„ æŒç»­æ”¹è¿›ä¸­

**æœ€åæ›´æ–°**: 2026-01-20
