# PC 客户端界面指南

**版本**: v5.0  
**日期**: 2026年1月27日  
**状态**: ✅ 已完成

---

## 📋 概述

VIMaster 现已支持 **PC 客户端界面**，基于 PyQt6 构建的原生桌面应用：

- 🏠 **首页** - 功能入口和快速开始
- 📊 **股票分析** - 单股详细分析
- 📈 **投资组合** - 批量分析多只股票
- 📜 **历史记录** - 查看分析历史
- ⚙️ **设置** - 配置参数

---

## 🆚 Web 版 vs PC 客户端对比

| 特性 | Web 版 | PC 客户端 |
|------|:------:|:--------:|
| **技术栈** | Flask + Bootstrap | PyQt6 |
| **运行方式** | 浏览器访问 | 原生应用 |
| **启动速度** | 需启动服务器 | 直接运行 |
| **离线使用** | ❌ | ✅ |
| **系统集成** | 有限 | 完整 |
| **性能** | 一般 | 更快 |
| **跨平台** | ✅ | ✅ |
| **安装依赖** | Flask | PyQt6 |

### 功能对比

| 功能 | Web 版 | PC 客户端 |
|------|:------:|:--------:|
| 首页仪表盘 | ✅ | ✅ |
| 股票分析 | ✅ | ✅ |
| 投资组合 | ✅ | ✅ |
| 历史记录 | ✅ | ✅ |
| 系统设置 | ✅ | ✅ |
| 热门股票 | ✅ | ✅ |
| 评分进度条 | ✅ | ✅ |
| 信号颜色标签 | ✅ | ✅ |
| 后台分析线程 | - | ✅ |
| 导出报告 | ✅ | ✅ |

---

## 🚀 快速开始

### 安装依赖

```bash
pip install PyQt6
```

### 启动客户端

```bash
python run_desktop.py
```

---

## 🎯 功能页面

### 1️⃣ 首页

- 大标题和副标题
- 功能特色卡片
- 快速开始按钮

### 2️⃣ 股票分析页面

- 股票代码输入框
- 热门股票快捷按钮
- 分析结果展示：
  - 综合评分进度条
  - 财务指标
  - 估值分析
  - 护城河评估
  - 风险评估
  - 投资决策

### 3️⃣ 投资组合页面

- 多行股票输入
- 预设组合按钮
- 结果表格（按评分排序）
- 汇总统计

### 4️⃣ 历史记录页面

- 历史记录表格
- 搜索过滤功能
- 刷新按钮

### 5️⃣ 设置页面

- 通用设置（数据源、缓存、线程）
- Agent 配置（权重参数）

---

## 🎨 界面预览

```
┌─────────────────────────────────────────────────────────────┐
│  VIMaster - 价值投资分析系统                    [−][□][×]  │
├─────────────────────────────────────────────────────────────┤
│  文件(F)  帮助(H)                                           │
├──────────┬──────────────────────────────────────────────────┤
│          │                                                  │
│ 🏠 首页   │  ┌─────────────────────────────────────────┐    │
│          │  │ 股票分析                                │    │
│ 📊 分析   │  │ [600519        ] [🔍 分析]             │    │
│          │  └─────────────────────────────────────────┘    │
│ 📈 组合   │  ┌─────────────────────────────────────────┐    │
│          │  │ 热门股票                                │    │
│ 📜 历史   │  │ [贵州茅台] [五粮液] [格力电器] [招商银行]│    │
│          │  └─────────────────────────────────────────┘    │
│ ⚙️ 设置   │                                                  │
│          │  ┌─────────────────────────────────────────┐    │
│          │  │ 📈 600519              [买入] 78.5分    │    │
│          │  ├─────────────────────────────────────────┤    │
│          │  │ 综合评分 [████████████░░░░] 78.5        │    │
│          │  ├─────────────────────────────────────────┤    │
│          │  │ 📊 财务指标    │ 💰 估值分析            │    │
│          │  │ 当前价格: ¥1800│ 内在价值: ¥2200       │    │
│          │  │ PE: 35.5      │ 合理价格: ¥2000       │    │
│          │  │ ROE: 32%      │ 安全边际: 11.1%       │    │
│          │  ├─────────────────────────────────────────┤    │
│          │  │ ✅ 投资决策                             │    │
│          │  │ 建议: 买入 | 仓位: 10% | 止损: ¥1620   │    │
│          │  └─────────────────────────────────────────┘    │
│          │                                                  │
├──────────┴──────────────────────────────────────────────────┤
│  就绪                                                       │
└─────────────────────────────────────────────────────────────┘
```

---

## 🛠 技术特性

### 多线程分析

```python
class AnalysisWorker(QThread):
    """后台分析线程"""
    finished = pyqtSignal(dict)
    error = pyqtSignal(str)
    progress = pyqtSignal(int, str)
```

- 分析过程不阻塞 UI
- 支持进度显示
- 错误处理

### 自定义控件

| 控件 | 用途 |
|------|------|
| `SignalLabel` | 带颜色的信号标签 |
| `ScoreBar` | 评分进度条 |
| `StockAnalysisPanel` | 股票分析面板 |
| `PortfolioPanel` | 投资组合面板 |
| `HistoryPanel` | 历史记录面板 |
| `SettingsPanel` | 设置面板 |

---

## 📂 文件结构

```
src/desktop/
├── app.py              # 主应用 (800+ 行)
└── __init__.py         # 包导出

run_desktop.py          # 启动脚本
```

---

## ⚙️ 依赖

```bash
pip install PyQt6
```

---

## 🔧 打包发布

### PyInstaller

```bash
pip install pyinstaller

pyinstaller --onefile --windowed --name VIMaster run_desktop.py
```

### Nuitka

```bash
pip install nuitka

nuitka --standalone --onefile --windows-disable-console run_desktop.py
```

---

## 🎨 主题定制

PC 客户端使用 Fusion 主题，支持自定义样式：

```python
# 设置应用样式
app.setStyle("Fusion")

# 自定义调色板
palette = QPalette()
palette.setColor(QPalette.ColorRole.Window, QColor(248, 249, 250))
app.setPalette(palette)
```

---

## 📊 代码统计

| 项目 | 数量 |
|------|------|
| 主应用模块 | 800+ 行 |
| 启动脚本 | 30 行 |
| 文档 | 250+ 行 |
| **总计** | **1,100+ 行** |

---

**项目状态**: 🟢 **已完成**  
**版本**: v5.0
